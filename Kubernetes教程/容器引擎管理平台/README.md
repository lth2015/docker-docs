容器引擎管理平台演讲稿
=================================================

#### 开场
各位尊敬的老师，上午/下午好！
我今天开题的题目是《基于PaaS的容器引擎管理平台的开发与应用》，我叫张婧茹，指导教师是郎宝军老师。

#### 项目背景及意义

##### 项目背景
首先，我想先介绍一下我课题的项目背景与意义。
随着互联网的快速发展和迅速普及，它已经深入到我们生产、生活的各个方面，尤其最近几年，O2O的兴起，更是从日常生活改变了我们的生活习惯。随着互联网业务涉及的行业越来越广，业务也越来越复杂多样，业务快速变化的同时也要求技术不断的更新，快速迭代，快速发布。

传统的软件发布流程漫长而复杂。传统的软件发布的流程涉及多个环节，多个环境: 包括从开发、测试，到准生产，生产等多个环境, 每次环境的迁移都涉及很多配置的变化，同时也涉及不同部门，不同人员之间的沟通成本，发布流水线上的部门要相互协调、配合，为了防止出现一些失误，我们制定了很多审批、发布流程，这使得沟通成本很高，发布流程漫长，效率很低。在传统的运维方式里面，还停留在手工部署，手工重启，手工运维的情况，手工的操作很容易引起操作失误，据不完全统计，人为操作失误引起的生产事故占总事故概率的1/4左右，有的公司更高。靠人工发布软件的另一个问题就是不能快速发布新版本，不能快速回滚，严重拖累软件的迭代、发布周期。

传统的软件发布（或者说运维）手段带了许许多多的问题，这经常让我们痛苦不堪，开发人员觉得运维人员不能很好的配合，不能快速发布、快速回滚，更何况快速的、动态的扩容；运维人员觉得自己的工作风险很高，稍有不慎就会造成生产事故，开发人员不理解，更极端的情况，运维觉得开发人员的发布频率太高了，应该方面一些。这些都是现有互联网企业普遍存在的问题，开发人员与运维人员的隔阂是真实存在的，它造成了我们发布的流程冗长而风险高，成本高而且事故率也很高，让技术人员痛苦不堪。我们一直在思考，有没有一种手段，让我们的软件发布更加流畅？让发布的过程更加便捷，而且风险很低？有没有一个平台，能让开发人员快速上线，快速部署？有没有一种技术，让基础设施的维护更加简便，为软件应用提供高稳定性的运行环境？答案就是我们今天的课题，一种基于PaaS的容器引擎管理平台。o

##### 解决方案

容器引擎管理平台借鉴和使用了最新的容器技术，它为我们上述的问题提供了一套解决方案，容器引擎管理平台具有如下特性或功能：
* 保证运维平台的高可用性
* 提供统一的运行环境、统一的配置
* 贯通代码流水线，打破开发和运维的界限
* 自动管理应用：健康检查和自愈
* 上线，回滚的过程在分钟级完成
* 支持应用的在线扩容、缩容
* 支持监控的可视化工具

容器引擎管理平台的解决问题的如下，首先通过一种统一的打包方式，让开发和运维能够有效的沟通，这种打包方式要比之前的方式快捷，最好，打包之后的文件更够直接运行。其次，基础设施自动化，或者说将基础设施抽象出来，为应用提供稳定的运行时环境，对计算资源、存储资源进行抽象，在资源层次做冗余，按需分配。我们按照这个思路来解决问题，这些功能都反应在我们的管理平台上。

##### 项目意义

容器引擎管理平台将应用打包成docker镜像，这里我们简单介绍一下docker技术，docker是基于Linux 容器技术的一种新兴的轻量级虚拟化技术，它基于Linux内核，以Linux进程的方式来运行一个操作系统，它是开源的，从2013年发布以后，受到了业界广泛的关注和应用。我们将打包的文件成为docker的镜像，运行时的进程我们称之为docker的容器。通俗的理解就是，DVD跟电影的关系。

容器引擎管理平台，打通了代码流水线，实现了持续集成和持续发布，让应用的迭代、发布更加快捷，大大的降低了成本，之前通过人工运维的工作都交由容器引擎管理平台来处理，运维人员只需点击几个按钮就可完成应用的发布，严格来讲，我们甚至可以实现一键升级，一键回滚，也能够实现滚动升级。

为了简便起见，我们对《容器引擎管理平台》简称为平台。

平台针对容器提供了针对容器的实时健康检查和自动恢复，例如，对于一个java web的应用，如果它的web接口不能返回预期的结果，我们认为它已经失效（或者说不健康），平台自动创建一个新的应用实例，删除这个不健康的应用实例。随着请求量的不断增加，平台根据预先设定的扩容、缩容算法，来自动增加、减少应用实例的个数。更大的亮点是，扩容一般能够在秒级完成，最坏的情形也能在分钟级结束。

#### 研究现状与研究内容

##### 国外容器云的发展现状

自docker技术发布以来，基于docker技术的容器云生态开始快速建立起来，其中各大互联网厂商和开源组织都加入进来，最著名的是Apache软件基金会的Mesos和Google公司的Kubernetes两款容器集群管理工具。Mesos致力于打造数据中心操作系统，Kubernetes的主要出发点是提供稳定、高效的容器调度、运行环境。Kubernetes基于Google内部的集群管理工具Borg开发，Borg也是基于Linux容器技术，Borg已经有十多年的稳定运行的经验，这使得Kubernetes一经发布，就在容器云领域占据了领袖地位。另外一款产品是，Docker官方出品的swarm，它相比前两个功能比较简单，但是发展也不较快，但是长期看来，Swarm的功能借鉴了Kubernetes和Mesos很多特点，它主要的竞争力是简单，小规模的集群使用没有问题，大规模的集群使用会有问题。

##### 国内容器技术的发展现状

国内的互联网公司相比国外的公司对Docker的使用还比较保守，大多数的互联网公司都以虚拟机的方式来看待和使用docker容器技术。他们以手工或自己开发的调度系统来创建、调度、销毁容器，也有的大的互联网公司，将kubernetes和mesos融合到自己的私有云建设中，甚至已经有了商业的方案，例如网易蜂巢和阿里聚石塔项目。

##### 研究内容、系统用例图

我们团队通过研究Docker已经Docker的生态，然后提出了构建自己的私有云——容器引擎管理平台。我们将平台主要分为下面几个大模块：

* 用户管理： 负责用户的注册与注销，资源使用配额的申请，自定义的部署模板管理
* 代码管理：将开发代码编译为Docker镜像并推送至公司内部的私有镜像仓库
* 镜像管理：对镜像仓库进行搜索和查找，查看在仓库里面的docker镜像的细节，还可以删除镜像
* 部署管理：实现应用上线、回滚、滚动升级、弹性扩容等功能
* 监控管理：实现数据中心的可视化，包括计算资源的实时监控和集群拓扑的实时显示

这幅图是平台的系统用例图，系统分为六个部分，以及各个部分的功能。


##### 持续集成（图示）

我们接下来看一下平台是如何实现持续集成的：从左到右看这幅图，开发人员开发完代码后，将代码提交至代码仓库，代码仓库触发持续集成的流程：即从代码仓库拉取代码，执行自动化测试、打包，然后构建成docker镜像，最后将docker镜像推送至公司内部的私有镜像仓库。整个过程可以重复进行，而且从代码合并到主干后，构建过程完全有系统自动化完成。

部署管理，它涵盖了应用的整个生命周期，包括升级、回滚、滚动升级和扩容、缩容。详细讲一下整个图的过程............发挥一下^-^

##### 监控管理——数据中心的可视化

数据中心的可是化包括两个部分，实时的计算资源监控和实时的拓扑结构显示，其中计算资源的监控包括每台计算节点的CPU，内存，磁盘的使用率，如果计算资源空闲过少，监控页面会以红色来显示计算节点，如果集群内所有的计算节点都是红色的，那么就要考虑立刻添加新的计算节点了。实时的拓扑结构显示，要展示一下内容：

* 所有正在运行的应用
* 所有应用的健康状态
* 每个应用在集群中的实例数
* 不同的应用之间的依赖关系
* 应用的资源使用限制
* 每个部门的资源使用配额
* 集群对内/外提供的服务
* 应用所在的计算节点（物理机）
* 物理机所在的数据中心

##### 弹性计算——自动扩容、缩容算法：

大概的算法描述是：
* 每隔5s采集一次应用的CPU使用率
* 计算最近一分钟内CPU使用的平均值：CurrentCPUUtilization
* 取得该应用的CPU使用限制：Target
* 计算扩容后的实例个数： TargetNum
* 公式：TargetNum = ceil(sum(CurrentCPUUtilization) / Target)（ceil为取整操作，sum为求和操作）
* 读取当前的实例个数：CurrentNum
** 扩容：创建(TargetNum - CurrentNum)个新的应用实例，扩容完成
** 缩容：删除(CurrentNum - TargetNum)个新的应用实例，缩容完成


#### 技术方案选型

##### 技术选型的需求

首先，平台应该是基于Web的系统，这其中包括很多因素，Web技术是业界的主流，让每个相关的人都能通过浏览器来访问我们的平台。其次要求web系统的开发成本低，开发效率高，尽量使用成熟的框架，避免重复制造轮子，还要能快速上手，快速迭代，社区成熟，资料充足。还有，技术要贴近主流云计算使用的技术，要是适合团队协作等等。

##### 技术选型

经过反复的调研和论证，我们决定采用如下方案：使用HTML，Bootstrap，JQuery， AngularJS编写Web前台，使用GO语言编写后台，Docker和Docker的主流生态，都是使用GO语言实现，后台数据采用NoSQL数据库，这里我们选择的是MongoDB。

下面是我们的整个系统的框架图，它包含几个部分....从左至右的说明了访问的过程....

#### 项目进度计划

##### 实施计划
* 2015.10-2016.2，完成容器生态系统调研，提出基于容器的应用发布解决方案，并详细论证、测试（已完成）
* 2016.02-2016.05，完成容器引擎管理平台架构设计、技术选型及论证
* 2016.05-2016.06，完成上线、回滚、滚动升级、弹性扩容的技术攻坚（并输出程序库）以及相关API设计
* 2016.06-2016.07，完成界面原型设计、数据库表设计、用户管理、部署模板设计
* 2016.07-2016.08，完成计算节点监控、集群拓扑可视化界面的设计
* 2016.08-2016.10，完成程序编码和单元测试
* 2016.10-2016.12，完成系统集成测试和准生产测试部署
* 2016.12-2017.02，完成系统在生产环境部署
* 2017.02-2017.03，完成论文编写，准备毕业答辩



衷心的感谢各位老师抽出宝贵的时间参加我的开题答辩，我的报告结束了，请各位老师提问，再次感谢老师，鞠躬致谢。


开始回答问题，你要小心了，不要挂上面.......

忠言逆耳.....
